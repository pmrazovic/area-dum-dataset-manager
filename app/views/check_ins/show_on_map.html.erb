<div class="col-lg-12">
  <ol class="breadcrumb">
    <li><%= link_to '<i class="fa fa-map-marker"></i> Check-Ins'.html_safe, check_ins_path %></li>
    <li class="active"><i class="fa fa-globe"></i> Show on map</li>
  </ol>
</div>


<div class="col-lg-9">
  <div class="row">
    <%= form_tag({action: :refresh_map_view}, :class => "form", :remote => true) do %>
      <div class='col-sm-3'>
        <div class="form-group">
          <%= label :start_time, "Start date and time", :class => "small" %>
          <div class="input-group date" id="startDatetimePicker">
            <%= text_field_tag :start_datetime, nil, class: 'form-control input-sm', data: { date_format: 'YYYY-MM-DD HH:mm' } %>
            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
          </div>
        </div>
      </div>

      <div class='col-sm-3'>
        <div class="form-group">
          <%= label :finish_time, "Finish date and time", :class => "small" %>
          <div class="input-group date" id="finishDatetimePicker">
            <%= text_field_tag :end_datetime, nil, class: 'form-control input-sm', data: { date_format: 'YYYY-MM-DD HH:mm' } %>
            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
          </div>
        </div>
      </div>
      <div class='col-sm-3'>
        <div class="form-group">
          <%= label :deliverer, "Deliverer", :class => "small" %>
          <%= select_tag :deliverer_id, options_for_select([["Nekaj_1",1],["Nekaj_2",2]]), :class => "form-control input-sm", :include_blank => "All" %>
        </div>
      </div>
      <div class='col-sm-3'>
        <div class="form-group">
          <%= submit_tag 'Refresh', :class => "btn btn-primary btn-sm", :style => "margin-top: 24px;", :onclick => "$('\#loader').show();" %><%= image_tag "loader.gif", :hidden => true, :id => "loader", :style => "width: 30px; margin-top: 24px; margin-left: 10px;" %>
        </div>
      </div>
    <% end %>
    <script type="text/javascript">
        $(function () {
            $('.date').datetimepicker({
                icons: {
                    time: 'fa fa-clock-o',
                    date: 'fa fa-calendar',
                    up: 'fa fa-arrow-up',
                    down: 'fa fa-arrow-down',
                    previous: 'fa fa-chevron-left',
                    next: 'fa fa-chevron-right',
                    clear: 'fa fa-trash',
                    close: 'fa fa-remove'
                },
                "defaultDate": new Date()
            });
        });
    </script>
  </div>


  <div class="row">
    <div style="width: 100%; height: 400px; margin-bottom: 20px;"  id="map"></div>
  </div>
</div>

<%= render :partial => "sidebar" %>

<script type='text/javascript'>
  var map = new L.Map('map', {center: new L.LatLng(41.386842, 2.170502), zoom: 12});
  var googleLayer = new L.Google('ROADMAP');
  map.addLayer(googleLayer);
  var markers = L.markerClusterGroup();
</script>